## Global macros

#macro(showstatus $status)
  #if($status.uRI.endsWith("Stable"))
    <span class="label label-success">Stable</span>
  #elseif($status.uRI.endsWith("Experimental"))
    <span class="label label-warning">Experimental</span>
  #elseif($status.uRI.endsWith("Submitted"))
    <span class="label">Submitted</span>
  #elseif($status.uRI.endsWith("Invalid"))
    <span class="label label-important">Invalid</span>
  #elseif($status.uRI.endsWith("Superseded"))
    <span class="label label-inverse">Superseded</span>
  #elseif($status.uRI.endsWith("Retired"))
    <span class="label label-inverse">Retired</span>
  #else
    $status.name
  #end
#end

#macro(linkhref $res)#if($res.uRI.startsWith($registry.baseURI))$res.uRI.substring($registry.baseURI.length())#else${root}/?entity=$lib.pathEncode($res.getURI())#end#end

#macro(linkfor $res)
   <a href="#linkhref($res)" title="$res.uRI">$res.name</a>
#end

#macro(render $v)
      #if($v.isResource())
        #linkfor($v)
      #else
        $lib.escapeHtml($v.lexicalForm, 1000)
      #end
#end

#macro(link $uri)
  <a href="$uri">$uri</a>
#end

## Display a property value in the RDF browser
#macro(resentry $v)
  #if($v.isList())
    <ul>
      #foreach($e in $v.asList())
        <li>#resentry($e)</li>
      #end
    </ul>
  #elseif($v.isAnon())
    #restable($v)
  #else
    #render($v)
  #end
#end

## Display a set of property/value pairs in the RDF browser
#macro(restable $res $classes)
  <table class="table $classes">
##    <thead><tr><th>Property</th><th>Value</th></tr></thead>
    <tbody>
      #foreach($pv in $res.listProperties())
        <tr>
          <td> <strong>$pv.getProp().name</strong> </td>
          <td>
            #foreach($v in $pv.getValues())
              #if($v.isList())
                  (#foreach($e in $v.asList())#resentry($e)#if( $foreach.hasNext ), #end#end)
              #elseif($v.isAnon())
                #restable($v)
              #else
                #resentry($v)
              #end
              #if( $foreach.hasNext )|#end
              #if( $foreach.count > 8 ) ... #break #end
            #end
            <br />
          </td>
        </tr>
      #end
    </tbody>
  </table>

#end

## Conditional row in a metadata table
#macro(metadatarow $label $values)
  #if(!$values.isEmpty())<tr><td><strong>$label</strong></td><td>#foreach($value in $values)#render($value)#if( $foreach.hasNext )| #end#end</td></tr>#end
#end

## Debug utility to display the roots of a model
#macro(showmodel $model)
  #foreach($root in $model.listSubjects())
    <h4>Root: $root.uRI</h4>
    #restable($root, "table-condensed table-bordered")
  #end
#end


